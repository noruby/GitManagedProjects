\documentclass[aps,prb,preprint]{revtex4-1}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{color}
\makeatletter

\begin{document}

\title{The Liouville equation for high harmonic generation in solid: the electromagnetic gauge dependence and the Bloch/Wannier representation}
\author{Nobuyoshi Hiramatsu}
\affiliation{Department of Applied Physics, the University of Tokyo}
\date{25 October 2017}
\begin{abstract}
We provide a derivation of of the Liouville equation in various representations and gauges .
\end{abstract}
\maketitle

%----------------------------------------------------------------------------------------------------------------------------------------
\section{Introduction}
Let $\hat{\rho}$ be the reduced density operator and $\hat{H}$ be the hamiltonian of the system, then the time development of the system is calculated by the Liouville equation, or the von Neumann equation.
\begin{eqnarray}
i \hbar \frac{\partial \hat{\rho} }{\partial t } &=&  [\hat{H}, \hat{\rho}] %\\
%#&=& \frac{\hat{H}\hat{\rho} - (\hat{H}\hat{\rho})^{\dag} }{i \hbar}  \nonumber 
\end{eqnarray}
The righthand side of the second line corresponds the anti-Hermite component of the $\hat{H}\hat{\rho}/ \hbar$.

Let $|{\bf m}>$ be the time-independent orthonormal basis satisfying the complete relation $\sum_{\bf m} |{\bf m}><{\bf m}| = {\bf 1}$. Then we have the matrix representation of the Liouville equation as follows.
\begin{eqnarray}
i \hbar \frac{ \partial }{\partial t } <{\bf m}| \hat{\rho} |{\bf m'}> &=&  <{\bf m}| \hat{H} \hat{\rho} - \hat{\rho} \hat{H} |{\bf m'}> \nonumber\\
&=&  \sum_{{\bf m''}} ( <{\bf m}| \hat{H} |{\bf m''}><{\bf m''}| \hat{\rho} |{\bf m'}> - <{\bf m}| \hat{\rho} |{\bf m''}><{\bf m''}| \hat{H} |{\bf m'}> ).\label{eq:LE2} \end{eqnarray} 

The Bloch states $\{ |n{\bf k}> \}$ and Wannier states $\{ |n{\bf R}> \}$ are the time-independent orthonormal basis.
with the band index $n$ and c,
When we consider a system interacting with electromagnetic field, the hamiltonian of the system is
 \begin{eqnarray}
 \hat{H} &=&\frac{ ({\bf \hat{p}} - e{\bf A})^2 }{2m} -e \phi + \hat{V}(x) \nonumber \\ 
 &=& H_0 + H_{int} 
 \end{eqnarray}
where ${\bf A}$ is the vector potential, $\phi$ is the scalar potential, $\hat{H}_0 = {\bf \hat{p}}^2/2m + \hat{V}(x)$ is the free hamiltonian without external electric filed, and $H_{int} =( - 2e{\bf A} \cdot {\bf \hat{p}} + e^2 |{\bf A}|^2)/2m -e \phi$ is the interaction hamiltonian with electric field.


Considering the electromagnetic gauge freedom, the interaction hamiltonian is not uniqely determined (See Appendix). For convenience, we consider the length and velocity gauge from the Coulomb gauge (i.e. the divergence of the vector potential vanishes $\nabla \cdot {\bf A} = 0$). In the length gauge, the vector potential is set to be 0 (${\bf A} = {\bf 0}$). On the other hand, in the velocity gauge($\phi = 0$
The corresponding interaction hamiltonian of the length gauge  $\hat{H}^{L}_{int}$ and that of the velocity gauge $\hat{H}^{V}_{int}$ are 
 \begin{eqnarray}
 \hat{H}^{L}_{int} &=&  -e{\bf E} \cdot {\bf \hat{x}}, \\
 \hat{H}^{V}_{int} &=& \frac{- 2e{\bf A} \cdot {\bf \hat{p}} + e^2 |{\bf A}|^2}{2m}. 
\end{eqnarray}
where ${\bf A} = - \int {\bf E} dt$ is the vector potential determined by the external electric filed. 

\textcolor{red}{emitted field is proportional to electric current flowing through the solid}
The current is separated into two parts: the interband current and intraband current.\cite{Foldi}
electric dipole is expressi

In this report, we calculated the spectra of HHG from solid by numerically solving the Liouville equation with four scheme: the Bloch representation with the length and velocity gauges (Chap. \ref{sec:BL} and \ref{sec:BV}, respectively), and the wannier representation with the length and velocity gauges (Chap. \ref{sec:WL} and \ref{sec:WV}, respectively)
%----------------------------------------------------------------------------------------------------------------------------------------

\section{Result}

\section{Discussion}

\section{Conclusion}

\newpage

\begin{appendix}
%----------------------------------------------------------------------------------------------------------------------------------------
\section{Bloch-basis and length gauge}
%In this section we provide the Liouville equation in the Bloch state $|n{\bf k}>$ and we fix the length gauge (i.e. ${\bf m} = \{n, {\bf k}\}$; $H_{int} =-e{\bf E} \cdot {\bf \hat{x}}$ ). 
%We assume that the coherence between the different momentum $ <n{\bf k}| \hat{\rho} |n'{\bf k'}> ({\bf k} \neq {\bf k})$ is negligible.
%\textcolor{red}{dipole approx., dipole transition, derivative}
%SBEに対応。
%
\begin{eqnarray}
<n{\bf k}|\hat{\bf x}|n''{\bf k''}>&=& <n{\bf k}| \{ -i \nabla_{\bf k''} e^{i{\bf k'' \cdot \hat{x} }} \} |u_{n''{\bf k''}}>\nonumber \\
&=&  -i \nabla_{\bf k''} <n{\bf k}|n''{\bf k''}> + i <u_{n{\bf k}}| e^{-i{\bf (k-k'') \cdot \hat{x} }} |\nabla_{\bf k''} u_{n''{\bf k''}}>\nonumber \\
&=&  -i \nabla_{\bf k''} <n{\bf k}|n''{\bf k''}> + \delta({\bf k-k''}) {\bf d}_{nn''}({\bf k}) \\
<n''{\bf k''}|\hat{\bf x}|n'{\bf k'}>&=& <u_{n''{\bf k''}}| \{ i \nabla_{\bf k''} e^{-i{\bf k'' \cdot \hat{x} }} \} |n'{\bf k'}>\nonumber \\
&=&  i \nabla_{\bf k''} <n''{\bf k''}|n'{\bf k'}> - i <\nabla_{\bf k"} u_{n''{\bf k''}}| e^{-i{\bf (k''-k') \cdot \hat{x} }} |u_{n'{\bf k'}}>\nonumber \\
&=&  i \nabla_{\bf k''} <n''{\bf k''}|n'{\bf k'}> + \delta({\bf k''-k'}) {\bf d}_{n''n'}({\bf k'})
\end{eqnarray} 
%where $\nabla_{\bf k''} <n{\bf k}|n''{\bf k''}>$ is the derivative of the generalized function.
%\textcolor{red}{note: delta fuction; momentum; $<u_{n{\bf k}}|\nabla_{\bf k} u_{n''{\bf k}}>$ is a function?}
%
%Here ${\bf d}_{nn''}({\bf k})$ and ${\bf d}_{n'n''}^*({\bf k})$ is defined as follows.
\begin{eqnarray}
i <u_{n{\bf k}}| e^{-i{\bf (k-k'' )\cdot \hat{x}} }|\nabla_{\bf k''} u_{n''{\bf k''}}> &=& i \int d{\bf x} <u_{n{\bf k}}|{\bf x}> <{\bf x}|\nabla_{\bf k''} u_{n''{\bf k''}}> e^{-i{\bf (k-k'' )\cdot {x}} }\nonumber \\
&=& i \sum_{\bf R} e^{-i{\bf (k-k'' )\cdot {\bf R}} } \int_{BL} d{\bf y} <u_{n{\bf k}}|{\bf y}> <{\bf y}|\nabla_{\bf k''} u_{n''{\bf k''}}> e^{-i{\bf (k-k'' )\cdot {y}} } \nonumber \\
&=& \delta({\bf k-k''})  ( i \int_{BL} d{\bf y}  <u_{n{\bf k}}|{\bf y}> <{\bf y}|\nabla_{\bf k''} u_{n''{\bf k''}}> )\nonumber \\
&\equiv& \delta({\bf k-k''}) {\bf d}_{nn''}({\bf k})\\
%
i <\nabla_{\bf k"} u_{n''{\bf k''}}| e^{-i{\bf (k''-k') \cdot \hat{x} }} |u_{n'{\bf k'}}> &=& i \int d{\bf x} <\nabla_{\bf k"} u_{n''{\bf k''}}|{\bf x}> <{\bf x}|u_{n'{\bf k'}}> e^{-i{\bf (k''-k' )\cdot {x}} }\nonumber \\
&=& i\sum_{\bf R} e^{-i{\bf (k''-k' )\cdot {\bf R}} } \int_{BL} d{\bf y} <\nabla_{\bf k"} u_{n''{\bf k''}}|{\bf y}> <{\bf y}|u_{n'{\bf k'}}> e^{-i{\bf (k''-k' )\cdot {y}} }\nonumber \\
&=& \delta({\bf k''-k'}) ( i \int_{BL} d{\bf y} <\nabla_{\bf k"} u_{n''{\bf k''}}|{\bf y}> <{\bf y}|u_{n'{\bf k'}}> )\nonumber \\
&=& - \delta({\bf k''-k'})  (i \int_{BL} d{\bf y} <u_{n'{\bf k'}}|{\bf y}> <{\bf y}|\nabla_{\bf k"} u_{n''{\bf k''}}>)^*\nonumber \\
&=& - \delta({\bf k''-k'}) {\bf d}_{n''n'}({\bf k'})
\end{eqnarray} 
%where the integral variable x runs in the entire space while y runs in a Blavais lattice.  
%
%We have a relation ${\bf d}_{n'n}({\bf k}) = {\bf d}_{nn'}^*({\bf k})$. Indeed, we obtain
\begin{eqnarray}
0 &=& i \nabla_{\bf k} <u_{n{\bf k}}|u_{n'{\bf k}}> \nonumber \\
 &=& i <\nabla_{\bf k} u_{n{\bf k}}|u_{n'{\bf k}}> + i <u_{n{\bf k}}|  \nabla_{\bf k} u_{n'{\bf k}}> \nonumber \\
 &=& - {\bf d}_{n'n}^*({\bf k}) + {\bf d}_{nn'}({\bf k}). 
 \end{eqnarray} 
 %
\begin{eqnarray}\label{eq:BL} 
i \hbar \frac{ \partial }{\partial t } &&<n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber \\
= && \sum_{n''} \int_{BZ} dk''  ( <n{\bf k}| \hat{H}_0 -e{\bf E} \cdot {\bf \hat{x}} |n''{\bf k''}><n''{\bf k''}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&&- <n{\bf k}| \hat{\rho} |n''{\bf k''}><n''{\bf k''}| \hat{H}_0 -e{\bf E} \cdot {\bf \hat{x}}  |n'{\bf k'}> )\nonumber  \\
= && (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&&-e{\bf E} \cdot \sum_{n''}\int_{BZ} dk'' ( <n{\bf k}| {\bf \hat{x}} |n''{\bf k''}> <n''{\bf k''}| \hat{\rho} |n'{\bf k'}> - <n{\bf k}| \hat{\rho} |n''{\bf k''}> <n''{\bf k''}| {\bf \hat{x}} |n'{\bf k'}> ) \nonumber  \\
= && (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&&-e{\bf E} \cdot [  i ( \nabla_{\bf k} + \nabla_{\bf k'} ) <n{\bf k}|\hat{\rho}|n'{\bf k'}> + \sum_{n''}\{ {\bf d}_{nn''}({\bf k})<n''{\bf k}|\hat{\rho}|n'{\bf k'}> - {\bf d}_{n''n'}({\bf k'})<n{\bf k}|\hat{\rho}|n''{\bf k'}> \} ] \nonumber  \\
\end{eqnarray}
%Here it is evident that the off-diagonal matrix elements respect to ${\bf k}$ does not couple diagonal elements. 

%We calculate the two band case. 
 \begin{eqnarray}
i \hbar \frac{ \partial }{\partial t } &&<v{\bf k}| \hat{\rho} |v{\bf k}> \nonumber \\
= && -e{\bf E} \cdot [  i \nabla_{\bf k} <v{\bf k}|\hat{\rho}|v{\bf k}> + \{ {\bf d}_{vc}({\bf k})<c{\bf k}|\hat{\rho}|v{\bf k}> - {\bf d}_{cv}({\bf k})<v{\bf k}|\hat{\rho}|c{\bf k}> \} ] \nonumber  \\
= && -e{\bf E} \cdot[  i \nabla_{\bf k} <v{\bf k}|\hat{\rho}|v{\bf k}> - 2i {\bf Im}\{ {\bf d}_{vc}^*({\bf k})<v{\bf k}|\hat{\rho}|c{\bf k}> \} ] \\
%
i \hbar \frac{ \partial }{\partial t } &&<c{\bf k}| \hat{\rho} |c{\bf k}> \nonumber \\
=&& -e{\bf E} \cdot [ i \nabla_{\bf k} <c{\bf k}|\hat{\rho}|c{\bf k}> + \{ {\bf d}_{cv}({\bf k})<v{\bf k}|\hat{\rho}|c{\bf k}> - {\bf d}_{vc}({\bf k})<c{\bf k}|\hat{\rho}|v{\bf k}> \} ] \nonumber  \\
=&& -e{\bf E} \cdot [ i \nabla_{\bf k} <c{\bf k}|\hat{\rho}|c{\bf k}> + 2i {\bf Im}\{ {\bf d}_{vc}^*({\bf k})<v{\bf k}|\hat{\rho}|c{\bf k}> \} ] \\
%
i \hbar \frac{ \partial }{\partial t } &&<v{\bf k}| \hat{\rho} |c{\bf k}> \nonumber \\
= && (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}> \nonumber  \\
&&-e{\bf E} \cdot [  i \nabla_{\bf k} <v{\bf k}|\hat{\rho}|c{\bf k}>  + \sum_{n''}\{ {\bf d}_{vn''}({\bf k})<n''{\bf k}|\hat{\rho}|c{\bf k}> - {\bf d}_{n''c}({\bf k})<v{\bf k}|\hat{\rho}|n''{\bf k}> \} ]\nonumber  \\
= && - (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}>  - i e{\bf E} \cdot \nabla_{\bf k} <v{\bf k}|\hat{\rho}|c{\bf k}> \nonumber  \\
&&-e{\bf E} \cdot [ \{ {\bf d}_{vv}({\bf k})-{\bf d}_{cc}({\bf k}) \} <v{\bf k}|\hat{\rho}|c{\bf k}> - {\bf d}_{vc}({\bf k}) \{ <c{\bf k}|\hat{\rho}|c{\bf k}> - <v{\bf k}|\hat{\rho}|v{\bf k}>  \} ] 
\end{eqnarray}

%----------------------------------------------------------------------------------------------------------------------------------------
\section{Bloch-basis and velocity gauge}
\begin{eqnarray}
[\hat{\bf x}, \hat{H}_0] = [\hat{\bf x}, \frac{\hat{\bf p}}{2m}]  =\frac{i \hbar}{m}\hat{\bf p}
\end{eqnarray} 

\begin{eqnarray}
<n{\bf k}|\hat{\bf p}|n'{\bf k'}> &=&i \frac{m(\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}})}{\hbar} <n{\bf k}|\hat{\bf x}|n'{\bf k'}> \nonumber \\
%&=& i\frac{m(\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}})}{\hbar}\{-i \nabla_{\bf k'} <n{\bf k}|n'{\bf k'}> + \delta({\bf k-k'}) {\bf d}_{nn'}({\bf k})\} \\
&=&\left\{
\begin{array}{l}
\frac{m}{\hbar}(\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}})\{-\nabla_{\bf k} <n{\bf k}|n'{\bf k'}> + i \delta({\bf k-k'}) {\bf d}_{nn'}({\bf k})\}  \\
\frac{m}{\hbar}(\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}})\{\nabla_{\bf k'} <n{\bf k}|n'{\bf k'}> + i \delta({\bf k-k'}) {\bf d}_{nn'}({\bf k})\} 
\end{array}
\right.
\end{eqnarray} 

%In particular if $\{n{\bf k}\}=\{n'{\bf k'}\}$ 
\begin{eqnarray}
<n{\bf k}|\hat{\bf p}|n{\bf k}> &=& \frac{m}{i \hbar} <n{\bf k}|[\hat{\bf x},\hat{H}_0]|n{\bf k}> \nonumber \\
&=& \frac{m}{i \hbar} \{ <u_{n{\bf k}}| (i \nabla_{\bf k} e^{-i{\bf k \cdot \hat{x} }} ) \hat{H}_0 |n{\bf k}> - <n{\bf k}| \hat{H}_0 (-i\nabla_{\bf k} e^{i{\bf k \cdot \hat{x}} }) |u_{n{\bf k}}> \} \nonumber \\
&=& \frac{m}{\hbar} \{  \nabla_{\bf k} <n{\bf k}|\hat{H}_0|n{\bf k}> - <\nabla_{\bf k} u_{n{\bf k}}| e^{-i{\bf k \cdot \hat{x}} } \hat{H}_0  |n{\bf k}> - <n{\bf k}| \hat{H}_0 e^{i{\bf k \cdot \hat{x}} }|\nabla_{\bf k} u_{n{\bf k}}> \} \nonumber \\
&=& \frac{m}{\hbar} \{  \nabla_{\bf k} \epsilon_{n{\bf k}} -  \epsilon_{n{\bf k}} \nabla_{\bf k} <u_{n{\bf k}}| u_{n{\bf k}}>\}  \nonumber \\
&=& \frac{m}{\hbar} \nabla_{\bf k} \epsilon_{n{\bf k}}
\end{eqnarray} 

%We derive general multi-band case in the velocity gauge and the Bloch representation (i.e. ${\bf m} = \{n, {\bf k}\}$; $H_{int} =( - 2e{\bf A} \cdot {\bf \hat{p}} + e^2 |{\bf A}|^2)/2m$ ), and apply the dipole approximation that we ignores the |${\bf A}|^2$ term. Then the Liouville equation become 
\begin{eqnarray}
i \hbar \frac{ \partial }{\partial t } &&<n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber \\
= &&  \sum_{n''} \int d{\bf k''} ( <n{\bf k}| \hat{H}_0 - \frac{e{\bf A} \cdot {\bf \hat{p}} }{m} |n''{\bf k''}><n''{\bf k''}| \hat{\rho} |n'{\bf k'}>  \nonumber \\
&&-<n{\bf k}| \hat{\rho} |n''{\bf k''}><n''{\bf k''}| \hat{H}_0 - \frac{e{\bf A} \cdot {\bf \hat{p}} }{m}  |n'{\bf k'}> )\nonumber \\
= && (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber \\
&& -\frac{e{\bf A}}{m} \cdot \sum_{n''} \int d{\bf k''}\{ <n{\bf k}|\hat{\bf p}|n''{\bf k''}> <n''{\bf k''}| \hat{\rho} |n'{\bf k'}> - <n{\bf k}| \hat{\rho} |n''{\bf k''}><n''{\bf k''}|\hat{\bf p} |n'{\bf k'}> \}  \nonumber \\
= && (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&& -\frac{e{\bf A}}{\hbar} \cdot \sum_{n''} \int d{\bf k''} [(\epsilon_{n{\bf k}}-\epsilon_{n''{\bf k''}})\{\nabla_{\bf k''} <n{\bf k}|n''{\bf k''}> + i \delta({\bf k-k''}) {\bf d}_{nn''}({\bf k})\} <n''{\bf k''}| \hat{\rho} |n'{\bf k'}>\nonumber  \\
&& - <n{\bf k}| \hat{\rho} |n''{\bf k''}>(\epsilon_{n''{\bf k''}}-\epsilon_{n'{\bf k'}})\{-\nabla_{\bf k''} <n''{\bf k''}|n'{\bf k'}> + i \delta({\bf k''-k'}) {\bf d}_{n''n'}({\bf k'})\} ] \nonumber \\
= && (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&& -\frac{e{\bf A}}{\hbar} \cdot (\nabla_{\bf k} \epsilon_{n{\bf k}} - \nabla_{\bf k'} \epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \nonumber  \\
&& -\frac{e{\bf A}}{\hbar} \cdot  \sum_{n''} [ (\epsilon_{n{\bf k}}-\epsilon_{n''{\bf k}}) {\bf d}_{nn''}({\bf k'}) <n''{\bf k}| \hat{\rho} |n'{\bf k'}>  -  (\epsilon_{n''{\bf k'}}-\epsilon_{n'{\bf k'}})<n{\bf k}| \hat{\rho} |n''{\bf k'}> {\bf d}_{n''n'}({\bf k'}) ] \nonumber \\
\end{eqnarray}
%Here it is evident that the off-diagonal matrix elements respect to ${\bf k}$ does not couple diagonal elements. 

%We calculate the two band case. 
\begin{eqnarray}
i \hbar \frac{ \partial }{\partial t } &&<v{\bf k}| \hat{\rho} |v{\bf k}> \nonumber \\
=&& -\frac{e{\bf A}}{\hbar} \cdot  \{ (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}}) {\bf d}_{vc}({\bf k}) <c{\bf k}| \hat{\rho} |v{\bf k}>  -  (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}})<v{\bf k}| \hat{\rho} |c{\bf k}> {\bf d}_{cv}({\bf k}) \nonumber \} \\
=&& +\frac{e{\bf A}}{\hbar} \cdot [2 (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) {\bf Re}\{ {\bf d}_{vc}^*({\bf k}) <v{\bf k}| \hat{\rho} |c{\bf k}> \} ] \\
%
i \hbar \frac{ \partial }{\partial t } &&<c{\bf k}| \hat{\rho} |c{\bf k}> \nonumber \\
=&& -\frac{e{\bf A}}{\hbar} \cdot \{ (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) {\bf d}_{cv}({\bf k}) <v{\bf k}| \hat{\rho} |c{\bf k}>  -  (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}})<c{\bf k}| \hat{\rho} |v{\bf k}> {\bf d}_{vc}({\bf k}) \} \nonumber \\
=&& -\frac{e{\bf A}}{\hbar} \cdot [ 2 (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) {\bf Re}\{ {\bf d}_{vc}^*({\bf k}) <v{\bf k}| \hat{\rho} |c{\bf k}> \} ] \\
%
i \hbar \frac{ \partial }{\partial t } &&<v{\bf k}| \hat{\rho} |c{\bf k}> \nonumber \\
= && (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}>  -\frac{e{\bf A}}{\hbar} \cdot \{ (\nabla_{\bf k} \epsilon_{v{\bf k}} - \nabla_{\bf k} \epsilon_{c{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}> \} \nonumber  \\
&& -\frac{e{\bf A}}{\hbar} \cdot  \{ (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}}) {\bf d}_{vc}({\bf k}) <c{\bf k}| \hat{\rho} |c{\bf k}>  -  (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}})<v{\bf k}| \hat{\rho} |v{\bf k}> {\bf d}_{vc}({\bf k}) \} \nonumber \\
= && - (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}>  + \frac{e{\bf A}}{\hbar} \cdot \{ (\nabla_{\bf k} \epsilon_{c{\bf k}} - \nabla_{\bf k} \epsilon_{v{\bf k}}) <v{\bf k}| \hat{\rho} |c{\bf k}> \} \nonumber  \\
&& + \frac{e{\bf A}}{\hbar} \cdot  \{ (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) {\bf d}_{vc}({\bf k}) ( <c{\bf k}| \hat{\rho} |c{\bf k}> - <v{\bf k}| \hat{\rho} |v{\bf k}> ) \}
\end{eqnarray}

%----------------------------------------------------------------------------------------------------------------------------------------
\section{Intraband, Interband, and anomalous current}
\begin{eqnarray}
J &=&  -e\frac{\partial}{\partial t} tr(\hat{\rho}\hat{\bf x}) \nonumber \\
&=&  -e\: tr(\frac{\partial \hat{\rho} }{\partial t}\hat{\bf x}) \nonumber \\
&=&  -\frac{e}{i \hbar} tr([\hat{H}, \hat{\rho}] \hat{\bf x}) \nonumber \\
&=&  -\frac{e}{i \hbar} tr\{\hat{\rho}(\hat{\bf x}\hat{H}-\hat{H}\hat{\bf x})\} \nonumber \\
&=&  -\frac{e}{i \hbar} tr\{\hat{\rho}[\hat{\bf x},\hat{H}]\} \nonumber \\
&=&  -\frac{e}{m} tr\{\hat{\rho}(\hat{\bf p}-e{\bf A})\} \nonumber \\
&=&   - \frac{e}{m} \sum_{nn'}\int d{\bf k} \int d{\bf k'} <n{\bf k}|\hat{\rho}|n'{\bf k'}><n'{\bf k'}|\hat{\bf p}|n{\bf k}> +\frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
&=&   -\frac{e}{\hbar} \sum_{nn'} \int d{\bf k}\int d{\bf k'} <n{\bf k}|\hat{\rho}|n'{\bf k'}> (\epsilon_{n'{\bf k'}}-\epsilon_{n{\bf k}})\{\nabla_{\bf k} <n'{\bf k'}|n{\bf k}> + i \delta({\bf k'-k}) {\bf d}_{n'n}({\bf k})\}  \nonumber \\
&& + \frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
&=&   +\frac{e}{\hbar} \sum_{nn'} \int d{\bf k}\int d{\bf k'} \nabla_{\bf k}\{<n{\bf k}|\hat{\rho}|n'{\bf k'}> (\epsilon_{n'{\bf k'}}-\epsilon_{n{\bf k}})\} <n'{\bf k'}|n{\bf k}>   \nonumber \\
&&   -\frac{e}{\hbar} \sum_{nn'} \int d{\bf k} <n{\bf k}|\hat{\rho}|n'{\bf k}> (\epsilon_{n'{\bf k}}-\epsilon_{n{\bf k}}) \{i {\bf d}_{n'n}({\bf k})\}  + \frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
&=&  -\frac{e}{\hbar} \sum_{n} \int d{\bf k} <n{\bf k}|\hat{\rho}|n{\bf k}> \nabla_{\bf k} \epsilon_{n{\bf k}}  -\frac{e}{\hbar} \sum_{nn'} \int d{\bf k} <n{\bf k}|\hat{\rho}|n'{\bf k}> (\epsilon_{n'{\bf k}}-\epsilon_{n{\bf k}}) \{i {\bf d}_{n'n}({\bf k})\}  + \frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
\end{eqnarray} 

\begin{eqnarray}
J_{2} &=&  -\frac{e}{\hbar} \int d{\bf k} (<v{\bf k}|\hat{\rho}|v{\bf k}> \nabla_{\bf k} \epsilon_{v{\bf k}} +<c{\bf k}|\hat{\rho}|c{\bf k}> \nabla_{\bf k} \epsilon_{c{\bf k}} ) + \frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
&& -\frac{e}{\hbar} \int d{\bf k} [ <v{\bf k}|\hat{\rho}|c{\bf k}> (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) \{i {\bf d}_{cv}({\bf k})\} + <c{\bf k}|\hat{\rho}|v{\bf k}> (\epsilon_{v{\bf k}}-\epsilon_{c{\bf k}}) \{i {\bf d}_{vc}({\bf k})\} ]  \nonumber \\
&=&  -\frac{e}{\hbar} \int d{\bf k} (<v{\bf k}|\hat{\rho}|v{\bf k}> \nabla_{\bf k} \epsilon_{v{\bf k}} +<c{\bf k}|\hat{\rho}|c{\bf k}> \nabla_{\bf k} \epsilon_{c{\bf k}} ) + \frac{e^2{\bf A}}{m}tr(\hat{\rho}) \nonumber \\
&& + \frac{e}{\hbar} \int d{\bf k} (\epsilon_{c{\bf k}}-\epsilon_{v{\bf k}}) {\bf Im}[ <v{\bf k}|\hat{\rho}|c{\bf k}>{\bf d}_{vc} ]  
\end{eqnarray} 
\newpage


%----------------------------------------------------------------------------------------------------------------------------------------
\section{The gauge transformations}
\begin{eqnarray}
|x> &\rightarrow& |x'> = U(x) |x> \\
|k> &\rightarrow& |k'> = U(k) |k>
\end{eqnarray} 
where $U(x)$ and $U(k)$ are unitary.
\textcolor{red}{note: I have no idea if U(x) and U(k) are independent. }

\begin{eqnarray}
\phi &\rightarrow& \phi' = \phi +\frac{\hbar}{e} \frac{\partial \chi}{\partial t} \\
{\bf A} &\rightarrow& {\bf A}' = +\frac{\hbar}{e} {\bf \nabla} \chi
\end{eqnarray} 
\textcolor{red}{note: $H^V$ is not the hamilton of the whole system; what is does A mean?}

\begin{eqnarray}
\hat{O} &\rightarrow& U^{\dag} \hat{O} U \nonumber 
\end{eqnarray} 

\begin{eqnarray}
e^A B e^{-A} = B+ [A,B] +\frac{1}{2}[A,[A,B]] + ... \nonumber  
\end{eqnarray} 

By Campbell-Baker-Hausdorff formula, the hamiltonian transforms as  
\begin{eqnarray}
\hat{H}^V &=& \frac{ ({\bf \hat{p}} - e{\bf A})^2 }{2m} + V(\hat{x}) \nonumber \nonumber \\ 
\rightarrow \hat{H}^L &=& exp(-\frac{ i e {\bf \widetilde{A} \cdot \hat{x}} }{\hbar}) \hat{H}^V exp( \frac{ i e {\bf \widetilde{A} \cdot \hat{x}}}{\hbar}) \nonumber \\
&=& \hat{H}^V + \frac{i e}{\hbar}[{\bf \widetilde{A} \cdot \hat{x} }, \hat{H}^V] + o^2 \nonumber \\
&=& \hat{H}^V + \frac{i e}{\hbar} \{ {\bf \widetilde{A}} \cdot [ {\bf \hat{x} }, \hat{H}^V] + [ {\bf \widetilde{A}} , \hat{H}^V] \cdot {\bf \hat{x} } \}+ o^2 \nonumber \\
&=& \hat{H}^V + \frac{i e}{\hbar} \{ {\bf \widetilde{A}} \cdot (i \hbar \frac{{\bf \hat{p}} - e{\bf A}}{m}) + (- i \hbar \frac{\partial \widetilde{\bf A}}{\partial t}) \cdot {\bf \hat{x} } \}+ o^2 \nonumber \\
&=& \frac{ \hat{\bf p}^2 }{2m} -e {\bf E \cdot \hat{\bf x}} + V(\hat{\bf x})+ (constant).\nonumber \\
\end{eqnarray} 
where the vector potential ${\bf \widetilde{A}}$ is formally an operator. 
\textcolor{red}{note: $H^V$ is not the hamilton of the whole system; what does A mean?}

By Campbell-Baker-Hausdorff formula, the hamiltonian transforms as  
\begin{eqnarray}
\hat{\rho}^V &\rightarrow& \hat{\rho}^L =exp(-\frac{ i e {\bf \widetilde{A} \cdot \hat{x}} }{\hbar}) \hat{\rho}^V exp( \frac{ i e {\bf \widetilde{A} \cdot \hat{x}}}{\hbar}) \nonumber \\
\end{eqnarray} 

%----------------------------------------------------------------------------------------------------------------------------------------
\section{variation principle and charge}

%----------------------------------------------------------------------------------------------------------------------------------------
\section{Wannier basis}
$n$ is the band index, $\bf k$ is the crystal momentum, ${\bf R} $ is the Bravais Lattice
The Bloch states $\{ |n{\bf k}> \}$ and Wannier states $\{ |n{\bf R}> \}$ are related by the Fourier expansion. 
\begin{eqnarray}
|n{\bf R}>&=&\frac{1}{\sqrt{\Omega}} \int_{BZ} dk \; exp(-i{\bf k} \cdot {\bf R})|n{\bf k}>\\
|n{\bf k}>&=&\frac{1}{\sqrt{N}} \sum_{\bf R} \; exp(i{\bf k} \cdot {\bf R}) 
\end{eqnarray} 
where $N$ is number of Bravais lattice points, and $\Omega$ is the volume of a Brillouin Zone. 
The matrix element of an operator $\hat{O}$ is transferred to 
\begin{eqnarray}
 < n{\bf R}| \hat{O} |n'{\bf R'}> \propto && \int \int_{BZ} dk dk'  \\
&& \times  exp[i ({\bf k} \cdot {\bf R}- {\bf k'} \cdot {\bf R'} ) ]< n{\bf k}| \hat{O} |n'{\bf k'}>  \nonumber 
\end{eqnarray} 
where $|u_{n''{\bf k''}}> = exp(-i{\bf k} \cdot \hat{\bf x}) |n''{\bf k''}>$ is the periodic part of the Bloch states.

%----------------------------------------------------------------------------------------------------------------------------------------
\section{the Wannier representation -Length gauge }
\label{sec:WL}
\begin{eqnarray*}
\frac{ \partial }{\partial t } &&<n{\bf R}| \hat{\rho} |n'{\bf R'}> \\
= && \frac{1}{i \hbar}  \sum_{n''{\bf R''}} ( <n{\bf R}| \hat{H}_0 -e{\bf E} \cdot {\bf \hat{x}} |n''{\bf R''}><n''{\bf R''}| \hat{\rho} |n'{\bf R'}> \\
&&- <n{\bf R}| \hat{\rho} |n''{\bf R''}><n''{\bf R''}| \hat{H}_0 -e{\bf E} \cdot {\bf \hat{x}}  |n'{\bf R'}> )\\
= &&\frac{1}{i \hbar} [ (\epsilon_{n{\bf k}}-\epsilon_{n'{\bf k'}}) <n{\bf k}| \hat{\rho} |n'{\bf k'}> \\
&& -e{\bf E} \cdot(<n{\bf k}| {\bf \hat{x}} |n{\bf k}> - <n'{\bf k'}| {\bf \hat{x}} |n'{\bf k'}> ) <n{\bf k}| \hat{\rho} |n'{\bf k'}>\\ 
&&-e{\bf E} \cdot \{ \sum_{n'' \neq n; {\bf k''}} <n{\bf k}| {\bf \hat{x}} |n''{\bf k''}> <n''{\bf k''}| \hat{\rho} |n'{\bf k'}> \\
&&- \sum_{n'' \neq n'; {\bf k''}} <n{\bf k}| \hat{\rho} |n''{\bf k''}> <n''{\bf k''}| {\bf \hat{x}} |n'{\bf k'}> \} ]
\end{eqnarray*}

\begin{eqnarray*}
\frac{ \partial \rho_{n',n}(l', l; t) }{\partial t } = \frac{1}{i \hbar} \sum_{n'',l''} \{ [ \epsilon_{n'}(l'-l'') \delta_{n'n''} ] \\
- eE_0 \cdot \Delta_{n'n''}(l'-l'') + eV_{n'n''}(l', l'')] \rho_{n'',n}\\
- [ \epsilon_{n}(l''-l) \delta_{n'n''} ] - eE_0 \cdot \Delta_{n'n''}(l'-l'') \\
+ eV_{n'n''}(l', l'')] \rho_{n'',n} \}
\end{eqnarray*}

ここで${\bf m}(x;t) = \frac{1}{\sqrt (N)} \sum_{l} exp(iK \dot l) A_n(x-l; t)$\\
$\epsilon_{n}(l'-l'')$と$\Delta_{nn'}(l-l')$は双極子遷移のフーリエ展開に対応\\
$\epsilon_{n}(l'-l'') =\frac{1}{N} \sum_K exp(-ik \cdot (l-l') ) \epsilon_n(k-\frac{e}{\hbar c}A_0)$\\
$\Delta_{nn'}(l-l')=\frac{1}{N}\sum_K exp(-ik \cdot (l-l') ) R_{nn'})(k) $\\
$V_{n'n}(l',l)= \int dx W^*_{n'}(x,l') V(x,t) W_n (x,l) $\\
$R_{nn'}(k) = \frac{i}{\Omega} \int dx U^*_{n'k} \nabla_k U_{nk}$\\

%----------------------------------------------------------------------------------------------------------------------------------------
\section{the Wannier representation -Velocity gauge }\cite{Iafrate} 
\label{sec:WV}

%\begin{eqnarray}
%A_n(x-l; t) $=$ \frac{1}{\sqrt(N)} \Sigm
%a_{k} exp(- iK \cdot l) {\bf m}(x;t)\\
%$=$ exp(i \frac{e}{i \hbar c} A_0 \cdot (x-l))
%\end{eqnarray}


\section{The Maximally localized Wannier function}
\end{appendix}


\bibliographystyle{unsrt}
\bibliography{bibtex}

\end{document}
