speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_time <- 2000
division_number_x <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #xy-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s 
wavenumber <- 1/(central_wavelength*100) #cm^-1
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
central_frequency
1/pulse_duration
repetition_rate
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_x <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #xy-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_frequency) #1/s
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_x <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #xy-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_frequency) #1/s
kx <- 2*pi/wavelength*sin(incident_angle)
ky <- 2*pi/wavelength*(-cos(incident_angle))
Ex_incident <- exp(-(incident_angle-incident_angle_mean)^2/(4*incident_angle_divergence^2))*cos(incident_angle)
Ey_incident <- exp(-(incident_angle-incident_angle_mean)^2/Ey_incident <- exp(-(incident_a)*sEy_incident <- exp(-(inncident <- exp(-(incidEy_incident <- exp(-(incident_angle-incident_angle_mean)^2/Ey_inc
y_incident <- exp(-(incident_idy_incident <- exp(-(incidendiny_incident <- exot_y_incident <- exp(-(incident_id2*y_incident <- exp(-(incident_idy_), length=division_number_frequency)
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_frequency) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
operating_frequency
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time <- setime <- setime <- set2*time <- setime <- setime <- set2nutime <- setime <- setime <-enttime <- setime <sitime <- setime <- setime <- set2*time <- setime <- setime <- set2metime <- setime <- setime <- seertime <- setime <- setime <-enttime <- setime <-entime <- setime <- setime <- set(1time <- setime <- setime <- set2*s_ttime <- setime <- setime <- set2 + Es_spectrum_incident[i]*exp(1i*operating_frequency[i]*time)
}division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time <- seq(-2*pulse_duration, 2*pulse_duration, length=division_nutime <- seq(-2*pulse_duratienttime <- seq(-2*psitime <- seq(-2*pulse_duration, 2*pulse_duration, length=divisionimetime <- seq(-2*pulse_duratiombertime <- seq(-2*pulse_duratienttime <- seq(-2*puentime <- seq(-2*pulse_duration, (1time <- seq(-2*pulse_duration, 2Es_ttime <- seq(-2*pulse_duration, 2 + Es_spectrum_incident[i]*exp(1i*operating_frequency[i]*time)
}
division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time <- seq(-2*pulse_duration, 2*pulse_duration, length=division_number_time) #s
Ep_time_incidentEp_time_incidentsiEp_time_incidentEp_time_incidentsiEp_time_incidentEp_time_incidenmeEp_time_incidentEp_time_incideerEp_time_incidentEp_time_incent <- Ep_time_incidenEp_time_incidentEp_time_inciden(1Ep_time_incidentEp_time_incidenEs_tEp_time_incidentEp_time_incidentsiEps_Ep_time_incidentEp_time_incidentsiEp_time_incidentEp_time}
time
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time <- setime <- setime <- set2*time <- setime <- setime <- set2nutime <- setime <- setime <-ent <- numeric(divisitime <- setime <- setime <- set2*time <- setime <- setime <- set2me) #0
time <- seq(-2*pulse_duration, 2*pulse_duration, length=division_number_time) #s
Ep_time_incident <- numeric(division_number_time) #0
Es_time_incident <- numeric(division_number_time) #0
for (i in 1:division_number_frequency){
Ep_time_incident <- Ep_time_incident + Ep_spectrum_incident[i]*exp(1i*operating_frequency[i]*time)
Es_time_incident <- Es_time_incident + Es_spectrum_incident[i]*exp(1i*operating_frequency[i]*time)
}
png("longitudinal_shift_time_domain.png", height=1300, width=1700, res=216)
par(mar = c(3, 3, 1, 1)) #  ä½™ç™½ã®åºƒã•ã‚’è¡Œæ•°ã§æŒ‡å®šï¼Žä¸‹ï¼Œå·¦ï¼Œä¸Šï¼Œå³ã®é †ï¼Ž
par(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ï¼Œè»¸ã®ä½ç½®ã‚’è¡Œã§æŒ‡å®šï¼Ž
plot(time*speed_of_light, Ep_time_incident,type="l",lwd=2, tcl=0.5, col="red",xlab=expression("x"~(mu~m)), ylab="amplitude")
par(new=T)
#axis(side=3, xlim=c(min(scattering_rate),max(scattering_rate)), at=c(221,261,313,384), labels=c("bulk",170,80,60), tck=1, col="blue", lty="dashed")
#mtext("Grain diameter (nm)*", side=3, line=1.5)
#axis(side=4, xlim=c(min(propagation_length),max(propagation_length)), at=c(9.0,12.0,14.7), labels=c("","",""), tck=1, col="green", lty="dashed")
#text(390,9.0, "wavelength: 800 nm")
dev.off()
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time <- setime <- setime <- set2*time <- setime <- setime <- son_nutime <- setime <- setime <-enttime <- setime isitime <- setime <- setime <- set2*time <- setime <- setime <- sotimetime <- setime <- setime <-umbertime <- setime <- setime <denttime <- setiincidentime <- setime <- setime <- exp(1time <- setime <- setime <- set2Es_ttime <- setime <- setime <- set2*t Es_time <- setime <- setime <- set2*time <- setime <- setime}
ime <- setime <- setime <- set2*inime <- setime <- setime <- 700, ime <- setime <- setime <- set2*inime <- set®åºƒã•ã‚’è¡Œæ•°ã§æŒ‡å®šï¼Žä¸‹ï¼Œå·¦ï¼Œä¸Šï¼Œå³ã®é †ï¼Ž
par(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ïpar(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ïpar(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ)),par(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ïpar(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½261par(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ïpar(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ãde=par(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼Žèª¬æ˜Žï¼Œãƒ©ãƒ™ãƒ«ïpar(mgp = c(1.5, 0.3, 0)) #  ä½™ç™½ã®ä½¿ã„æ–¹ï¼",""), tck=1, col="green", lty="dashed")
#text(390,9.0, "wavelength: 800 nm")
dev.off()
speed_of_light <- 299792458 #m/s
#calculation parameter
division_number_frequency <- 2000
division_number_time <- 2000
#property of gold
scattering_rate <- 384 #cm^-1 (<380 cm^-1 for grain size of >56nm)
plasma_frequency <-67900 #cm^-1
dielectric_background <- 7.0
#parameter physics
jones_vector <- c(1,0) #ps-basis
incident_angle <- 85/180*pi#radian
central_wavelength <- 800 *10^(-9) #m
central_frequency <- speed_of_light/central_wavelength #1/s
pulse_duration <- 50 *10^(-15) #s 
repetition_rate <- 1*10^3 #1/s
wavenumber <- 1/(central_wavelength*100) #cm^-1
#operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, by=repetition_rate) #1/s
operating_frequency <- seq(central_frequency-5/pulse_duration, central_frequency+5/pulse_duration, length=division_number_frequency) #1/s
Ep_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[1]
Es_spectrum_incident <- exp(-(operating_frequency-central_frequency)^2/(pulse_duration^2))*jones_vector[2]
time_coordtime_coordtime_coorse_dtime_coordtime_coordtime_coorngth=time_coordtime_coordtime_co_time_incident <- numtime_coordtime_coordtime_coorse_dtime_coordtime_coordtime_coorngtn_time_coordtime_coordtime_coodivitime_coordtime_coordtime_co_time_incident <- Ep_ttime_coordtime_coordtime_coorsedetime_coordtime_coordtime_coorscy[i]*time_coordtime_coordtime_coorse_dtim- time_coordtime_coordtime_coorse_dtime_coordtime_coordtime_g_frequency[i]*time_coordinate)
}
quit()
